---
import DocsLayoutComponent from "@farming-labs/astro-theme/src/components/DocsLayout.astro";
import DocsContentComponent from "@farming-labs/astro-theme/src/components/DocsContent.astro";
import SearchDialog from "@farming-labs/astro-theme/src/components/SearchDialog.astro";
import FloatingAIChat from "@farming-labs/astro-theme/src/components/FloatingAIChat.astro";
import config from "../../lib/docs.config";
import { load } from "../../lib/docs.server";
import "@farming-labs/astro-theme/pixel-border/css";

const data = await load(Astro.url.pathname);
const showFloatingAI = config?.ai?.enabled && config?.ai?.mode === "floating";
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{data.title} â€“ Docs</title>
    {data.description && <meta name="description" content={data.description} />}
  </head>
  <body>
    <DocsLayoutComponent tree={data.tree} config={config}>
      <DocsContentComponent data={data} config={config} />
    </DocsLayoutComponent>
    <SearchDialog config={config} />
    {showFloatingAI && (
      <FloatingAIChat
        api="/api/docs"
        suggestedQuestions={config.ai.suggestedQuestions ?? []}
        aiLabel={config.ai.aiLabel ?? "AI"}
        position={config.ai.position ?? "bottom-right"}
        floatingStyle={config.ai.floatingStyle ?? "panel"}
      />
    )}
  </body>
</html>
